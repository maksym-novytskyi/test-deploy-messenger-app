{"ast":null,"code":"import _toConsumableArray from\"/Users/max/Desktop/Programing/JavaScript/GitHub/testDeploy/test-deploy-messenger-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/max/Desktop/Programing/JavaScript/GitHub/testDeploy/test-deploy-messenger-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import ChatsWindowComponent from\"./ChatsComponent/ChatsWindowComponent\";import DialogWindowComponent from\"./DialogWindowComponent/DialogWindowComponent\";import notificationSound from'../../notificationSound.mp3';import'./AppComponent.scss';import{useEffect,useRef,useState}from\"react\";import{useHttp}from\"../../hooks/http.hook\";import{fetchUsers,usersUpdated}from\"../../actions\";import{useDispatch,useSelector}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AppComponent=function AppComponent(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),userActive=_useState2[0],setUserActive=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),term=_useState6[0],setTerm=_useState6[1];useEffect(function(){window.scrollTo(0,0);},[]);var audioPlayer=useRef(null);var playAudio=function playAudio(){audioPlayer.current.currentTime=0;audioPlayer.current.play();};var sortingUsers=function sortingUsers(state){var arrOfDate=state.usersReducer.users.map(function(el){return+el.messages.slice(-1)[0].date;});var sortDate=arrOfDate.sort(function(a,b){return b-a;});var sortUsers=sortDate.map(function(d){return state.usersReducer.users.filter(function(u){return+u.messages.slice(-1)[0].date===d;});});return searchUsers(sortUsers.flat(),term);};var searchUsers=function searchUsers(items,term){if(term.length===0){return items;}return items.filter(function(item){return item.userName.toLowerCase().indexOf(term.toLowerCase())>-1;});};var onUpdateSearch=function onUpdateSearch(term){setTerm(term);};var users=useSelector(function(state){return sortingUsers(state);});var dispatch=useDispatch();var _useHttp=useHttp(),request=_useHttp.request;useEffect(function(){dispatch(fetchUsers(request));},[request]);var openChat=function openChat(user){setUserActive(user);setMessages(user.messages);};var updateMessages=function updateMessages(newMessage){setMessages([].concat(_toConsumableArray(messages),[newMessage]));userActive.messages=[].concat(_toConsumableArray(messages),[newMessage]);request(\"http://maksym-novytskyi.github.io:3001/users/\".concat(userActive.id),\"PUT\",JSON.stringify(userActive)).then(dispatch(usersUpdated(userActive))).catch(function(err){return console.log(err);});};var updateGetMessages=function updateGetMessages(newMessage,newGetMessage){setMessages([].concat(_toConsumableArray(messages),[newMessage,newGetMessage]));userActive.messages=[].concat(_toConsumableArray(messages),[newMessage,newGetMessage]);request(\"http://maksym-novytskyi.github.io:3001/users/\".concat(userActive.id),\"PUT\",JSON.stringify(userActive)).then(dispatch(usersUpdated(userActive))).catch(function(err){return console.log(err);});playAudio();};return/*#__PURE__*/_jsxs(\"div\",{className:'appComponent',children:[/*#__PURE__*/_jsx(\"audio\",{src:notificationSound,ref:audioPlayer}),/*#__PURE__*/_jsx(ChatsWindowComponent,{onUpdateSearch:onUpdateSearch,isOnline:true,openChat:openChat,users:users}),userActive?/*#__PURE__*/_jsx(DialogWindowComponent,{updateMesseges:updateMessages,updateGetMessages:updateGetMessages,messages:messages,userActive:userActive}):/*#__PURE__*/_jsx(\"div\",{className:'chooseDialog',children:/*#__PURE__*/_jsx(\"h3\",{children:\"Select a chat to start messaging\"})})]});};export default AppComponent;","map":{"version":3,"names":["ChatsWindowComponent","DialogWindowComponent","notificationSound","useEffect","useRef","useState","useHttp","fetchUsers","usersUpdated","useDispatch","useSelector","AppComponent","userActive","setUserActive","messages","setMessages","term","setTerm","window","scrollTo","audioPlayer","playAudio","current","currentTime","play","sortingUsers","state","arrOfDate","usersReducer","users","map","el","slice","date","sortDate","sort","a","b","sortUsers","d","filter","u","searchUsers","flat","items","length","item","userName","toLowerCase","indexOf","onUpdateSearch","dispatch","request","openChat","user","updateMessages","newMessage","id","JSON","stringify","then","catch","err","console","log","updateGetMessages","newGetMessage"],"sources":["/Users/max/Desktop/Programing/JavaScript/GitHub/testDeploy/test-deploy-messenger-app/src/Components/AppComponent/AppComponent.jsx"],"sourcesContent":["import ChatsWindowComponent from \"./ChatsComponent/ChatsWindowComponent\";\nimport DialogWindowComponent from \"./DialogWindowComponent/DialogWindowComponent\";\nimport notificationSound from '../../notificationSound.mp3'\n\nimport './AppComponent.scss'\nimport {useEffect, useRef, useState} from \"react\";\nimport {useHttp} from \"../../hooks/http.hook\";\nimport {fetchUsers, usersUpdated} from \"../../actions\";\nimport {useDispatch, useSelector} from \"react-redux\";\n\nconst AppComponent = () => {\n    const [userActive, setUserActive] = useState();\n    const [messages, setMessages] = useState();\n    const [term, setTerm] = useState('');\n    useEffect(() => {\n        window.scrollTo(0, 0)\n    }, [])\n    const audioPlayer = useRef(null);\n    const playAudio = () => {\n        audioPlayer.current.currentTime = 0;\n        audioPlayer.current.play();\n    }\n\n    const sortingUsers = (state) => {\n        const arrOfDate = state.usersReducer.users.map(el => +el.messages.slice(-1)[0].date);\n        const sortDate = arrOfDate.sort((a, b) => b - a);\n        const sortUsers = sortDate.map(d => {\n            return state.usersReducer.users.filter(u => +u.messages.slice(-1)[0].date === d);\n        })\n        return searchUsers(sortUsers.flat(), term);\n    }\n\n    const searchUsers = (items, term) => {\n        if (term.length === 0) {\n            return items;\n        }\n\n        return items.filter(item => {\n            return item.userName.toLowerCase().indexOf(term.toLowerCase()) > -1\n        })\n    }\n\n    const onUpdateSearch = (term) => {\n        setTerm(term);\n    }\n    const users = useSelector(state => sortingUsers(state));\n    const dispatch = useDispatch();\n    const {request} = useHttp();\n\n    useEffect(() => {\n        dispatch(fetchUsers(request));\n    }, [request])\n\n    const openChat = (user) => {\n        setUserActive(user);\n        setMessages(user.messages);\n    }\n\n    const updateMessages = (newMessage) => {\n        setMessages([...messages, newMessage]);\n        userActive.messages = [...messages, newMessage]\n        request(`http://maksym-novytskyi.github.io:3001/users/${userActive.id}`, \"PUT\", JSON.stringify(userActive))\n            .then(dispatch(usersUpdated(userActive)))\n            .catch(err => console.log(err));\n    }\n    const updateGetMessages = (newMessage, newGetMessage) => {\n        setMessages([...messages, newMessage, newGetMessage]);\n        userActive.messages = [...messages, newMessage, newGetMessage]\n        request(`http://maksym-novytskyi.github.io:3001/users/${userActive.id}`, \"PUT\", JSON.stringify(userActive))\n            .then(dispatch(usersUpdated(userActive)))\n            .catch(err => console.log(err));\n        playAudio();\n    }\n    return (\n        <div className={'appComponent'}>\n            <audio src={notificationSound} ref={audioPlayer}/>\n            <ChatsWindowComponent onUpdateSearch={onUpdateSearch} isOnline={true} openChat={openChat} users={users}/>\n            {userActive ? <DialogWindowComponent updateMesseges={updateMessages}\n                                                 updateGetMessages={updateGetMessages}\n                                                 messages={messages}\n                                                 userActive={userActive}/>\n                : <div className={'chooseDialog'}><h3>Select a chat to start messaging</h3></div>}\n        </div>\n    );\n}\n\nexport default AppComponent;"],"mappings":"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"},"metadata":{},"sourceType":"module"}